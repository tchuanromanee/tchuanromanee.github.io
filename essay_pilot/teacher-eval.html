<html>
    <head>
        <link href="css/annotator.css" rel="stylesheet" type="text/css">
    </head>
	<body>

        <script src="build/annotator.min.js" type="text/javascript"></script>
        <script src="js/annotatorExtra.js" type="text/javascript"></script>
        <script src="lib/jquery-1.8.2.js" type="text/javascript"></script>

        <script src="http://cdn.rawgit.com/DmitryBaranovskiy/raphael/master/raphael-min.js" type="text/javascript"></script>

        <section id = "evaluation">
			       To un-highlight text, click on the highlighted portion again.
             <h2>Teacher Evaluation - Ratings</h2>
             <table >
            	<tbody>
            		<tr>
            			<td>No Basis</td>
            			<td> </td>
            			<td>Below Average</td>
            			<td>Average</td>
            			<td>Good <br /> (Above average)</td>
            			<td>Very Good <br /> (Well above average)</td>
            			<td>Excellent <br /> (Top 10%)</td>
            			<td>Outstanding <br /> (Top 5%)</td>
            			<td>Top Few</td>
            		</tr>
            		<tr>
            			<td> </td>
            			<td>Academic Achievement</td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
            		<tr>
            			<td> </td>
            			<td>Intellectual Promise</td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
            		<tr>
            			<td> </td>
            			<td>Quality of Writing</td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
            		<tr>
            			<td> </td>
            			<td>Creative Thought</td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
            		<tr>
            			<td> </td>
            			<td>Productive Discussion</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
            		<tr>
            			<td> </td>
            			<td>Faculty Respect</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
            		<tr>
            			<td> </td>
            			<td>Disciplined Habits</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
            		<tr>
            			<td> </td>
            			<td>Maturity</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            		</tr>
            		<tr>
            			<td> </td>
            			<td>Motivation</td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
            		<tr>
            			<td> </td>
            			<td>Leadership</td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
            		<tr>
            			<td> </td>
            			<td>Integrity</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
                <tr>
            			<td> </td>
            			<td>Reaction to Setbacks</td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
                <tr>
            			<td> </td>
            			<td>Concern for Others</td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
                <tr>
            			<td> </td>
            			<td>Self-confidence</td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
                <tr>
            			<td> </td>
            			<td>Initiative</td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
                <tr>
            			<td> </td>
            			<td>OVERALL</td>
            			<td> </td>
            			<td> </td>
            			<td>x</td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            			<td> </td>
            		</tr>
            	</tbody>
            </table>
            <h2>Teacher Evaluation - Letter</h2>
            <div>
                <p id='p2' style="display: inline">

                My name is XY and I am the college counselor at X High School in State. I have been in this role since the beginning of the 2017-18 academic year. Prior to coming
  to CRCHS, I worked in undergraduate admissions at a mid-sized private university for ten years.
  Being able to bring that experience to an environment that challenges, supports, and
  encourages students to pursue their college dreams has been incredibly fulfilling.
  Cristo Rey is a school that believes in finding the potential in every young person by providing
  them the resources necessary to tap into that energy. The vast majority of our students are
  coming from a low-income household and they are able to access a college-prep, Catholic
  education through the Professional Work-Study Program. Our president, Jim Foley, recently
  wrote, “The Professional Work-Study Program is a unique way that businesses can change the
  lives of students who have limited educational options. This is the secret sauce of Cristo Rey
  Columbus. Students learning to do real, professional work and making significant contributions
  at their jobs is a good thing. Knowing that their work experience allows them to afford a
  college-prep education, learn about career possibilities, and develop a strong sense of
  professionalism is a great thing. It is nothing short of transforming Columbus one student at a
  time.”
</p>
<p>
  <strong>Distinctive Qualities</strong>
  <ul>
    <li>The student is simply relentless. She immigrated to the United States as a child, Naturally,
  there were some challenges in terms of her transition. She has systematically tackled
  each and every one of them. She has mentioned to me the effort she has put into
  developing her proficiency in English and navigating the cultural norms that exist in the
  US.</li>
</ul>
<p>
  <strong>Academic and Intellectual Growth and Trends</strong>
  <ul>
    <li>Student is a solid student. Her strengths are in areas that involve group work and
  project management. This is evident in her push to open up and operate the school’s
  spirit store, an entity that was dormant until she made the push her junior year to revive
  it. I think this is also emblematic of the academic transformation she went between her
  sophomore
</li>
</ul>
</p>
<p>
  <strong>Areas of Impact</strong>
  <ul>
      <li>She has a wide variety of interests and I could see her thriving in a whole host of areas.
Personally, I think she would do well in a business field. She has the tenacity and
intelligence to be able to run her own business or help lead a large scale project from
start to finish.</li>
</ul>
</p>
<p>
would be an amazing asset to any institution. I’m happy to answer any questions
regarding her candidacy.
</p>
Sincerely, <br />Counselor
             </div>
        </section>
        <section id ="continue">
          <p>
            Please make sure you have made your selections before continuing.
          </p>
        </section>
        <section id ="firstRate">
          Please rate the student.
          <ul class="likert">
            <li class="likert"> Very Weak <input id="firstRateStart" type="radio" name="firstRatingRadio" value="1" required/>
            <li class="likert"><input type="radio" name="firstRatingRadio" value="2" />
            <li class="likert"><input type="radio" name="firstRatingRadio" value="3" />
            <li class="likert"><input type="radio" name="firstRatingRadio" value="4" />
            <li class="likert"><input id="firstRateEnd" type="radio" name="firstRatingRadio" value="5" /> Very Strong
        </ul>
        <br />
        </section>
        <section id = "evaluationVis">
			       To un-highlight text, click on the highlighted portion again.

             <div class="row">
               <div class="column" id="leftCol">
                 <div id="3" class="tooltip"><img src="img/gpa.png" style="width:100%;"><span class="tooltiptext">GPA is okay</span></div>
                 <br />
                 <div id="4" class="tooltip"><img src="img/courses.png" style="width:100%;"><span class="tooltiptext">Took a good amount of courses</span></div>

               </div>
               <div class="column" style="background-color:#bbb;" id="rightCol">
                 <h2>Teacher Evaluation - Ratings</h2>
                 (INSERT TABLE HERE)
               </div>
             </div>
             <p></p>
             <div class="row">
               <div class="column" id="leftCol">

                 <div id="3" class="tooltip"><img src="img/testscores.png" style="width:100%;"><span class="tooltiptext">Test scores below average</span></div>
                 <br />
                 <div id="4" class="tooltip"><img src="img/activities.png" style="width:100%;"><span class="tooltiptext">Dedicated to extracurriculars</span></div>

               </div>
               <div class="column" style="background-color:#bbb;" id="rightCol">
             <h2>Teacher Evaluation - Letter</h2>
             <div>
                 <p id='p2' style="display: inline">

                 My name is XY and I am the college counselor at X High School in State. I have been in this role since the beginning of the 2017-18 academic year. Prior to coming
                 to CRCHS, I worked in undergraduate admissions at a mid-sized private university for ten years.
                 Being able to bring that experience to an environment that challenges, supports, and
                 encourages students to pursue their college dreams has been incredibly fulfilling.
                 Cristo Rey is a school that believes in finding the potential in every young person by providing
                 them the resources necessary to tap into that energy. The vast majority of our students are
                 coming from a low-income household and they are able to access a college-prep, Catholic
                 education through the Professional Work-Study Program. Our president, Jim Foley, recently
                 wrote, “The Professional Work-Study Program is a unique way that businesses can change the
                 lives of students who have limited educational options. This is the secret sauce of Cristo Rey
                 Columbus. Students learning to do real, professional work and making significant contributions
                 at their jobs is a good thing. Knowing that their work experience allows them to afford a
                 college-prep education, learn about career possibilities, and develop a strong sense of
                 professionalism is a great thing. It is nothing short of transforming Columbus one student at a
                 time.”
               </p>
               <p>
               <strong>Distinctive Qualities</strong>
               <ul>
                 <li>The student is simply relentless. She immigrated to the United States as a child, Naturally,
               there were some challenges in terms of her transition. She has systematically tackled
               each and every one of them. She has mentioned to me the effort she has put into
               developing her proficiency in English and navigating the cultural norms that exist in the
               US.</li>
             </ul>
             <p>
             <strong>Academic and Intellectual Growth and Trends</strong>
             <ul>
               <li>Student is a solid student. Her strengths are in areas that involve group work and
             project management. This is evident in her push to open up and operate the school’s
             spirit store, an entity that was dormant until she made the push her junior year to revive
             it. I think this is also emblematic of the academic transformation she went between her
             sophomore
           </li>
           </ul>
           </p>
           <p>
             <strong>Areas of Impact</strong>
             <ul>
                 <li>She has a wide variety of interests and I could see her thriving in a whole host of areas.
           Personally, I think she would do well in a business field. She has the tenacity and
           intelligence to be able to run her own business or help lead a large scale project from
           <div id="1" class="badevidence tooltip" onmouseover="showEvidence(this)" onmouseout="hideEvidence(this)">start to finish.<span class="tooltiptext">More explanation here</span></div></li>
           </ul>
           </p>
           <p>
           Student would be an amazing asset to any institution. I’m happy to answer any questions
           regarding her candidacy.
           </p>
           Sincerely, <br />Counselor
         </div>
       </div>

             </div>

             <!--
             <div id="3" class="tooltip"><img src="img/Difficulty-85-green.svg"><span class="tooltiptext">This is an okay score for someone at this level</span></div> <br />
             <div id="4" class="tooltip"><img src="img/Sentiment-positive.svg"><span class="tooltiptext">A positive sentiment</span></div><br />
             <div id="5" class="tooltip"><img src="img/Emotion-Surprise-orange.svg"><span class="tooltiptext">Score of 0.019</span></div><br />
             <div id="6" class="tooltip"><img src="img/Emotion-Joy-blue.svg"><span class="tooltiptext">Score of 0.005</span></div><br />
           -->
        </section>
        <section id ="secondRate">
          Please rate the student.
          <ul class="likert">
            <li class="likert"> Very Weak <input id="secondRateStart" type="radio" name="secondRatingRadio" value="1" required/>
            <li class="likert"><input type="radio" name="secondRatingRadio" value="2" />
            <li class="likert"><input type="radio" name="secondRatingRadio" value="3" />
            <li class="likert"><input type="radio" name="secondRatingRadio" value="4" />
            <li class="likert"><input id="secondRateEnd" type="radio" name="secondRatingRadio" value="5" /> Very Strong
        </ul>
        <br />
        </section>
        <second id ="finished">
          Finished!
        </section>
        <script src='https://cdn.rawgit.com/timdown/rangy/master/lib/rangy-core.js' type="text/javascript"></script>
        <script src='https://cdn.rawgit.com/timdown/rangy/master/lib/rangy-classapplier.js' type="text/javascript"></script>
        <script type="text/javascript">
            var maxArraySize = 50;
            var u = new tvs.Annotator();
            u.annotateDocument();
		        //var pElem2 = $('#p2')[0];
            // Data to save
            var allSelected = [];
            var firstEssayRating;
            var allVisSelected = [];
            var secondEssayRating;

            //var $select2 = $('<select></select>'),
            var $body = $(document.body);
            var essay = document.getElementById("evaluation");
            var firstRated = false;
            // Hide subsequent sections
            var firstRateSection = document.getElementById("firstRate");
            firstRateSection.style.display = "none";
            var evaluationVisSection = document.getElementById("evaluationVis");
            evaluationVisSection.style.display = "none";
            var secondRateSection = document.getElementById("secondRate");
            secondRateSection.style.display = "none";
            var finishedSection = document.getElementById("finished");
            finishedSection.style.display = "none";

            // Create buttons: Highlight text essay
            var highlightButton = document.createElement("button");
            var highlightButtonText = document.createTextNode("Highlight");
            highlightButton.appendChild(highlightButtonText);
            highlightButton.setAttribute("id", "highlightButton");
            essay.appendChild(highlightButton);

            // Create button: next button after highlight is done
            var nextButtonRate = document.createElement("button");
            var nextButtonText = document.createTextNode("Continue");
            nextButtonRate.appendChild(nextButtonText);
            nextButtonRate.setAttribute("id", "submitEssayHighlight");
            document.getElementById("continue").appendChild(nextButtonRate)
            nextButtonRate.onclick = rateEssay;


            // Create button: next button after rating is selected
            var ratingSubmitButton = document.createElement("button");
            var ratingSubmitButtonText = document.createTextNode("Submit Rating");
            ratingSubmitButton.appendChild(ratingSubmitButtonText);
            ratingSubmitButton.setAttribute("id", "submitFirstRating");
            document.getElementById("firstRate").appendChild(ratingSubmitButton)
            ratingSubmitButton.onclick = submitFirstEssayRating;


            // Create buttons: Highlight essay vis

            var highlightButtonVis = document.createElement("button");
            var highlightButtonVisText = document.createTextNode("Highlight");
            highlightButtonVis.appendChild(highlightButtonVisText);
            highlightButtonVis.setAttribute("id", "highlightButtonVis2");
            evaluationVisSection.appendChild(highlightButtonVis);


            // Create button: Essay vis continue button
            var nextButtonRate2 = document.createElement("button");
            var nextButtonText2 = document.createTextNode("Continue");
            nextButtonRate2.appendChild(nextButtonText2);
            nextButtonRate2.setAttribute("id", "submitEssayHighlight2");
            evaluationVisSection.appendChild(nextButtonRate2)
            nextButtonRate2.onclick = rateEssayVis;

            // Create button: next button after rating is selected
            var ratingSubmitButton2 = document.createElement("button");
            var ratingSubmitButtonText2 = document.createTextNode("Submit Rating");
            ratingSubmitButton2.appendChild(ratingSubmitButtonText2);
            ratingSubmitButton2.setAttribute("id", "submitSecondRating");
            document.getElementById("secondRate").appendChild(ratingSubmitButton2)
            ratingSubmitButton2.onclick = submitSecondEssayRating;

            function createCtrl2(title, clickHandler) {
              highlightButton.onclick = function() {
				            //getSelectionText();
                    //node.setAttribute("id", highlightCount.toString());
                    clickHandler.apply(u, ['solid', 'blue']);
              };
              highlightButtonVis.onclick = function() {
				            //getSelectionText();
                    //node.setAttribute("id", highlightCount.toString());
                    clickHandler.apply(u, ['solid', 'blue']);
              };

            }
            createCtrl2('highlight', u.highlightSelected);

            //If the highlighted text is clicked on, it will be removed
            $body.on('click', '.tvs-annotated-text, .tvs-annotate-element', function(e) {
            u.unannotateElement(this);

				//get the ID of the highlighted text?
				//var listItemToRem = document.getElementById("mySelect");
				//x.remove(x.selectedIndex);
            });

            var highlightCount = 0;
      			function getSelectionText() {
      				var text = "";
      				if (window.getSelection) {
      					text = window.getSelection().toString();
      				} else if (document.selection && document.selection.type != "Control") {
      					text = document.selection.createRange().text;
      				}
      				highlightCount++;
      				//appendText(text, highlightCount);
              // add to an array of selected text
              allSelected.push(text);
              //console.log(allSelected);
      				//return text;
      			}

            // Process  the essay selection and switch to rating the student
            function rateEssay() {
              var firstRateSection = document.getElementById("firstRate");
              if (firstRateSection.style.display === "none") {
                firstRateSection.style.display = "block";
              }
              var essaySection = document.getElementById("evaluation");
              //var essayList = document.getElementById("essaySection");
              essaySection.style.display = "none";
              document.getElementById("continue").style.display = "none";
              //essayList.style.display = "none";

              // Remove and extract all annotations from essayList
              $(document).ready(function(){
                var allspans = $("#evaluation").find("span"); // get list of all annotation spans in essay
                //var allspans = essay.getElementsByClassName(".tvs-annotated-text, .tvs-annotate-element")
                console.log(allspans)
                var i;
                //Unannotate all and extract
                //$body.on('click', '.tvs-annotated-text, .tvs-annotate-element', function(e) {
                for (i = 0; i < allspans.length; i++) {
                  console.log(allspans[i].innerHTML);
                  allSelected.push(allspans[i].innerHTML);
                  u.unannotateElement(allspans[i]);
                  //allspans[i].onclick = function() { console.log('we did it'); };

                  //$("div").find("span").css({"color": "red", "border": "2px solid red"});
                }
              });

            }

            function rateEssayVis() {
              if (secondRateSection.style.display === "none") {
                secondRateSection.style.display = "block";
              }
              evaluationVisSection.style.display = "none";
              document.getElementById("continue").style.display = "none";

              // Remove and extract all annotations from essayList
              $(document).ready(function(){
                var allspans = $("#evaluationVis").find("span"); // get list of all annotation spans in essay
                //var allspans = essay.getElementsByClassName(".tvs-annotated-text, .tvs-annotate-element")
                console.log(allspans)
                var i;
                //Unannotate all and extract
                //$body.on('click', '.tvs-annotated-text, .tvs-annotate-element', function(e) {
                for (i = 0; i < allspans.length; i++) {
                  console.log(allspans[i].innerHTML);
                  allVisSelected.push(allspans[i].innerHTML);
                  u.unannotateElement(allspans[i]);
                  //allspans[i].onclick = function() { console.log('we did it'); };

                  //$("div").find("span").css({"color": "red", "border": "2px solid red"});
                }
              });

            }

            function submitFirstEssayRating() {
              var radios = document.getElementsByName('firstRatingRadio');
              // Get the value of the rating
              for (var i = 0, length = radios.length; i < length; i++) {
               if (radios[i].checked) {
                essayRating = radios[i].value;
                // only one radio can be logically checked, don't check the rest
               }
             }

              // No need to check if a rating has been selected since it's required in HTML
                firstRateSection.style.display = "none";
                evaluationVisSection.style.display = "block";
                firstRated = true;
            }


            function submitSecondEssayRating() {
              var radios = document.getElementsByName('secondRatingRadio');
              // Get the value of the rating
              for (var i = 0, length = radios.length; i < length; i++) {
               if (radios[i].checked) {
                essayRating = radios[i].value;
                // only one radio can be logically checked, don't check the rest
               }
              }
                //Go to end
                secondRateSection.style.display = "none";
                finishedSection.style.display = "block";

                //TO DO: Extract data
                //firstRated = true;


            }

      			/*function appendText(highlightedText, highlightCount) {
      				var node = document.createElement("LI");                 // Create a <li> node
      				node.setAttribute("id", highlightCount.toString());
      				var textnode = document.createTextNode(highlightedText);         // Create a text node
      				node.appendChild(textnode);                              // Append the text to <li>
      				document.getElementById("essayList").appendChild(node);     // Append <li> to <ul> with id="myList"
      			}*/
            var evidence = ['bad grammar', 'good vocabulary']
            function showEvidence(spanInput) {
              var evidenceNum = spanInput.id.toString();
              var thisEvidence = evidence[evidenceNum];
              console.log(thisEvidence)


            }

            function hideEvidence(spanInput) {
              console.log(spanInput)
            }


        </script>



	</body>
</html>
